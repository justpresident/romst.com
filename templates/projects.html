{#
Projects listing page - shows all projects with sidebar
Groups are automatically constructed from extra.group values
#}

{%- extends "base.html" %}

{%- block seo %}
  {{- super() }}
  {%- set title = section.title %}
  {%- set description = section.description %}
  {{- macros_seo::seo(config=config, title=title, title_addition=config.extra.title_addition, description=description, is_home=false) }}
{%- endblock seo %}

{%- block content %}
<div>
<h1>{{ section.title }}_</h1>
<p class="proj-desc">{{ section.description }}</p>

{# Collect unique groups dynamically #}
{%- set groups_seen = [] %}
{%- for project in section.pages %}
  {%- if project.extra.group and project.extra.group not in groups_seen %}
    {%- set_global groups_seen = groups_seen | concat(with=project.extra.group) %}
  {%- endif %}
{%- endfor %}

<div class="projects-list">
{%- for group_name in groups_seen %}
<div class="project-group">
  <h2>► {{ group_name }}</h2>
  {%- for project in section.pages %}
  {%- if project.extra.group == group_name %}
  <div class="project-card">
    <h3><a href="{{ project.extra.project_url | safe }}">{{ project.title }}</a></h3>
    <p>{{ project.description }}</p>
    <a href="{{ project.extra.project_url | safe }}" class="project-link">Launch →</a>
  </div>
  {%- endif %}
  {%- endfor %}
</div>
{%- endfor %}
</div>
</div>

{# Projects Sidebar - dynamically grouped #}
<div class="sblock">
  <div class="blockdiv sticky">
    <span class="b s150">Projects</span>
    {%- for group_name in groups_seen %}
    <div class="tpad"><strong class="s90">{{ group_name }}</strong></div>
    {%- for project in section.pages %}
    {%- if project.extra.group == group_name %}
    <div class="tpad">
      <a href="{{ project.extra.project_url | safe }}" title="{{ project.description }}">{{ project.title }}</a>
    </div>
    {%- endif %}
    {%- endfor %}
    {%- endfor %}
  </div>
</div>

<style>
.proj-desc {
  color: #606060;
  margin-bottom: 2rem;
}
.projects-list {
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
}
.project-group h2 {
  color: #ff66ff;
  font-family: 'Courier New', monospace;
  font-size: 1.1rem;
  margin-bottom: 1rem;
  text-transform: uppercase;
  letter-spacing: 2px;
}
.project-card {
  background: #0f0f0f;
  border: 1px solid #1a1a1a;
  border-left: 3px solid #00ff88;
  padding: 1.2rem;
  margin-bottom: 0.8rem;
  border-radius: 4px;
  transition: all 0.2s ease;
}
.project-card:hover {
  border-left-color: #00ffff;
  box-shadow: 0 0 15px rgba(0, 255, 136, 0.1);
}
.project-card h3 {
  margin: 0 0 0.5rem 0;
  font-size: 1.2rem;
}
.project-card h3 a {
  color: #00ff88 !important;
}
.project-card h3 a:hover {
  color: #00ffff !important;
}
.project-card p {
  color: #b0b0b0;
  margin: 0 0 0.8rem 0;
  font-size: 0.95rem;
}
.project-link {
  display: inline-block;
  color: #ffaa00 !important;
  font-family: 'Courier New', monospace;
  font-size: 0.9rem;
}
.project-link:hover {
  color: #ffcc44 !important;
  text-shadow: 0 0 8px rgba(255, 170, 0, 0.5);
}
</style>
{%- endblock content %}
